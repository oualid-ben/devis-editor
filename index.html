<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>√âditeur de Devis</title>
  <style>
    body { font-family: sans-serif; background: #f8f9fc; padding: 2rem; }
    input { padding: 0.5rem; border-radius: 0.25rem; border: 1px solid #ccc; width: 100%; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; background: white; border-radius: 0.5rem; overflow: hidden; }
    th, td { border: 1px solid #ddd; padding: 0.75rem; text-align: left; }
    .section { display: flex; gap: 1rem; margin-bottom: 1rem; }
    .btn { padding: 0.5rem 1rem; border: none; border-radius: 5px; cursor: pointer; }
    .primary { background: #4f46e5; color: white; }
    .secondary { background: #e0e7ff; color: #1e1b4b; }
  </style>
</head>
<body>
  <h2>Modifier les informations du devis</h2>
  <div class="section">
    <div><label>Num√©ro du devis : <input id="numDevis" value="D-MAN-250622-002"></label></div>
    <div><label>Date : <input type="date" id="date" value="2025-06-22"></label></div>
    <div><label>Objet : <input id="objet" value="Peinture int√©rieure salon"></label></div>
    <div><label>Devise : <input id="devise" value="EUR"></label></div>
  </div>
  <div><strong>Client : </strong><span id="client">Jean Dupont</span></div>

  <table id="devisTable">
    <thead>
      <tr><th>Prestation</th><th>Quantit√©</th><th>Unit√©</th><th>Prix Unitaire</th><th>TVA (%)</th><th>Total HT</th><th>Total TTC</th></tr>
    </thead>
    <tbody id="prestations">
      <tr>
        <td><input value="Peinture"></td>
        <td><input type="number" value="5"></td>
        <td><input value="m2"></td>
        <td><input type="number" value="50"></td>
        <td><input type="number" value="20"></td>
        <td class="ht"></td>
        <td class="ttc"></td>
      </tr>
    </tbody>
  </table>
  <button class="btn primary" onclick="ajouterLigne()">+ Ajouter une ligne</button>

  <div class="section">
    <label>Remise globale (‚Ç¨) : <input id="remise" type="number" value="0"></label>
  </div>

  <div id="totaux" style="margin-top: 1rem;"></div>

  <div class="section">
    <button class="btn secondary" onclick="imprimerPDF()">üñ∏Ô∏è Imprimer ou Enregistrer en PDF</button>
  </div>

  <script>
    function calculerTotaux() {
      let totalHT = 0;
      let totalTVA = 0;
      document.querySelectorAll("#prestations tr").forEach(row => {
        const qte = +row.children[1].children[0].value;
        const prix = +row.children[3].children[0].value;
        const tva = +row.children[4].children[0].value;
        const ht = qte * prix;
        const montantTVA = ht * (tva / 100);
        const ttc = ht + montantTVA;
        row.querySelector(".ht").innerText = ht.toFixed(2);
        row.querySelector(".ttc").innerText = ttc.toFixed(2);
        totalHT += ht;
        totalTVA += montantTVA;
      });
      const remise = +document.getElementById("remise").value;
      const sousTotal = totalHT - remise;
      const totalTTC = sousTotal + totalTVA;
      document.getElementById("totaux").innerHTML = `
        <p>Total HT : ‚Ç¨${totalHT.toFixed(2)}</p>
        <p>Remise : ‚Ç¨${remise.toFixed(2)}</p>
        <p>Sous-total : ‚Ç¨${sousTotal.toFixed(2)}</p>
        <p>TVA : ‚Ç¨${totalTVA.toFixed(2)}</p>
        <p><strong>Total TTC : ‚Ç¨${totalTTC.toFixed(2)}</strong></p>
      `;
    }

    function ajouterLigne() {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><input></td>
        <td><input type="number"></td>
        <td><input></td>
        <td><input type="number"></td>
        <td><input type="number"></td>
        <td class="ht"></td>
        <td class="ttc"></td>
      `;
      document.getElementById("prestations").appendChild(tr);
    }

    function imprimerPDF() {
      window.print();
    }

    document.addEventListener("input", calculerTotaux);
    window.onload = calculerTotaux;
  </script>
</body>
</html>

